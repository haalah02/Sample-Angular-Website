{"ast":null,"code":"import { EventEmitter } from \"@angular/core\";\nimport { switchMap, takeUntil } from \"rxjs/operators\";\nimport { EMPTY, Subject } from \"rxjs\";\nimport { NgClass } from \"@angular/common\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../core/services/profile.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../../core/services/user.service\";\nconst _c0 = function (a0, a1, a2) {\n  return {\n    disabled: a0,\n    \"btn-outline-secondary\": a1,\n    \"btn-secondary\": a2\n  };\n};\nexport class FollowButtonComponent {\n  constructor(profileService, router, userService) {\n    this.profileService = profileService;\n    this.router = router;\n    this.userService = userService;\n    this.toggle = new EventEmitter();\n    this.isSubmitting = false;\n    this.destroy$ = new Subject();\n  }\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n  toggleFollowing() {\n    this.isSubmitting = true;\n    this.userService.isAuthenticated.pipe(switchMap(isAuthenticated => {\n      if (!isAuthenticated) {\n        void this.router.navigate([\"/login\"]);\n        return EMPTY;\n      }\n      if (!this.profile.following) {\n        return this.profileService.follow(this.profile.username);\n      } else {\n        return this.profileService.unfollow(this.profile.username);\n      }\n    }), takeUntil(this.destroy$)).subscribe({\n      next: profile => {\n        this.isSubmitting = false;\n        this.toggle.emit(profile);\n      },\n      error: () => this.isSubmitting = false\n    });\n  }\n}\nFollowButtonComponent.ɵfac = function FollowButtonComponent_Factory(t) {\n  return new (t || FollowButtonComponent)(i0.ɵɵdirectiveInject(i1.ProfileService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.UserService));\n};\nFollowButtonComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: FollowButtonComponent,\n  selectors: [[\"app-follow-button\"]],\n  inputs: {\n    profile: \"profile\"\n  },\n  outputs: {\n    toggle: \"toggle\"\n  },\n  standalone: true,\n  features: [i0.ɵɵStandaloneFeature],\n  decls: 3,\n  vars: 7,\n  consts: [[1, \"btn\", \"btn-sm\", \"action-btn\", 3, \"ngClass\", \"click\"], [1, \"ion-plus-round\"]],\n  template: function FollowButtonComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"button\", 0);\n      i0.ɵɵlistener(\"click\", function FollowButtonComponent_Template_button_click_0_listener() {\n        return ctx.toggleFollowing();\n      });\n      i0.ɵɵelement(1, \"i\", 1);\n      i0.ɵɵtext(2);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(3, _c0, ctx.isSubmitting, !ctx.profile.following, ctx.profile.following));\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate2(\" \\u00A0 \", ctx.profile.following ? \"Unfollow\" : \"Follow\", \" \", ctx.profile.username, \"\\n\");\n    }\n  },\n  dependencies: [NgClass],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"AAAA,SAEEA,YAAY,QAIP,eAAe;AAEtB,SAASC,SAAS,EAAEC,SAAS,QAAQ,gBAAgB;AACrD,SAASC,KAAK,EAAEC,OAAO,QAAQ,MAAM;AAIrC,SAASC,OAAO,QAAQ,iBAAiB;;;;;;;;;;;;AAQzC,OAAM,MAAOC,qBAAqB;EAMhCC,YACmBC,cAA8B,EAC9BC,MAAc,EACdC,WAAwB;IAFxB,mBAAc,GAAdF,cAAc;IACd,WAAM,GAANC,MAAM;IACN,gBAAW,GAAXC,WAAW;IAPpB,WAAM,GAAG,IAAIV,YAAY,EAAW;IAC9C,iBAAY,GAAG,KAAK;IACpB,aAAQ,GAAG,IAAII,OAAO,EAAQ;EAM3B;EAEHO,WAAW;IACT,IAAI,CAACC,QAAQ,CAACC,IAAI,EAAE;IACpB,IAAI,CAACD,QAAQ,CAACE,QAAQ,EAAE;EAC1B;EAEAC,eAAe;IACb,IAAI,CAACC,YAAY,GAAG,IAAI;IAExB,IAAI,CAACN,WAAW,CAACO,eAAe,CAC7BC,IAAI,CACHjB,SAAS,CAAEgB,eAAwB,IAAI;MACrC,IAAI,CAACA,eAAe,EAAE;QACpB,KAAK,IAAI,CAACR,MAAM,CAACU,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;QACrC,OAAOhB,KAAK;;MAGd,IAAI,CAAC,IAAI,CAACiB,OAAO,CAACC,SAAS,EAAE;QAC3B,OAAO,IAAI,CAACb,cAAc,CAACc,MAAM,CAAC,IAAI,CAACF,OAAO,CAACG,QAAQ,CAAC;OACzD,MAAM;QACL,OAAO,IAAI,CAACf,cAAc,CAACgB,QAAQ,CAAC,IAAI,CAACJ,OAAO,CAACG,QAAQ,CAAC;;IAE9D,CAAC,CAAC,EACFrB,SAAS,CAAC,IAAI,CAACU,QAAQ,CAAC,CACzB,CACAa,SAAS,CAAC;MACTZ,IAAI,EAAGO,OAAO,IAAI;QAChB,IAAI,CAACJ,YAAY,GAAG,KAAK;QACzB,IAAI,CAACU,MAAM,CAACC,IAAI,CAACP,OAAO,CAAC;MAC3B,CAAC;MACDQ,KAAK,EAAE,MAAO,IAAI,CAACZ,YAAY,GAAG;KACnC,CAAC;EACN;;AA3CWV,qBAAqB;mBAArBA,qBAAqB;AAAA;AAArBA,qBAAqB;QAArBA,qBAAqB;EAAAuB;EAAAC;IAAAV;EAAA;EAAAW;IAAAL;EAAA;EAAAM;EAAAC;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCrBlCC,iCAQC;MADCA;QAAA,OAASC,qBAAiB;MAAA,EAAC;MAE3BD,uBAA8B;MAC9BA,YAEF;MAAAA,iBAAS;;;MAVPA,qHAIE;MAIFA,eAEF;MAFEA,iHAEF;;;iBDMYjC,OAAO;EAAAmC;AAAA","names":["EventEmitter","switchMap","takeUntil","EMPTY","Subject","NgClass","FollowButtonComponent","constructor","profileService","router","userService","ngOnDestroy","destroy$","next","complete","toggleFollowing","isSubmitting","isAuthenticated","pipe","navigate","profile","following","follow","username","unfollow","subscribe","toggle","emit","error","selectors","inputs","outputs","standalone","features","decls","vars","consts","template","i0","ctx","encapsulation"],"sourceRoot":"","sources":["/Users/haalahibrahim/Desktop/Sample-Angular-Website/src/app/shared/buttons/follow-button.component.ts","/Users/haalahibrahim/Desktop/Sample-Angular-Website/src/app/shared/buttons/follow-button.component.html"],"sourcesContent":["import {\n  Component,\n  EventEmitter,\n  Input,\n  OnDestroy,\n  Output,\n} from \"@angular/core\";\nimport { Router } from \"@angular/router\";\nimport { switchMap, takeUntil } from \"rxjs/operators\";\nimport { EMPTY, Subject } from \"rxjs\";\nimport { ProfileService } from \"../../core/services/profile.service\";\nimport { UserService } from \"../../core/services/user.service\";\nimport { Profile } from \"../../core/models/profile.model\";\nimport { NgClass } from \"@angular/common\";\n\n@Component({\n  selector: \"app-follow-button\",\n  templateUrl: \"./follow-button.component.html\",\n  imports: [NgClass],\n  standalone: true,\n})\nexport class FollowButtonComponent implements OnDestroy {\n  @Input() profile!: Profile;\n  @Output() toggle = new EventEmitter<Profile>();\n  isSubmitting = false;\n  destroy$ = new Subject<void>();\n\n  constructor(\n    private readonly profileService: ProfileService,\n    private readonly router: Router,\n    private readonly userService: UserService\n  ) {}\n\n  ngOnDestroy(): void {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  toggleFollowing(): void {\n    this.isSubmitting = true;\n\n    this.userService.isAuthenticated\n      .pipe(\n        switchMap((isAuthenticated: boolean) => {\n          if (!isAuthenticated) {\n            void this.router.navigate([\"/login\"]);\n            return EMPTY;\n          }\n\n          if (!this.profile.following) {\n            return this.profileService.follow(this.profile.username);\n          } else {\n            return this.profileService.unfollow(this.profile.username);\n          }\n        }),\n        takeUntil(this.destroy$)\n      )\n      .subscribe({\n        next: (profile) => {\n          this.isSubmitting = false;\n          this.toggle.emit(profile);\n        },\n        error: () => (this.isSubmitting = false),\n      });\n  }\n}\n","<button\n  class=\"btn btn-sm action-btn\"\n  [ngClass]=\"{\n    disabled: isSubmitting,\n    'btn-outline-secondary': !profile.following,\n    'btn-secondary': profile.following\n  }\"\n  (click)=\"toggleFollowing()\"\n>\n  <i class=\"ion-plus-round\"></i>\n  &nbsp;\n  {{ profile.following ? \"Unfollow\" : \"Follow\" }} {{ profile.username }}\n</button>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}